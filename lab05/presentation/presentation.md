---
## Лабораторная работа №5
Вероятностные тесты на простоту чисел
Выполнил: Хамза Хуссен

## Цель работы:
Изучение, программная реализация и сравнительный анализ трёх вероятностных алгоритмов проверки чисел на простоту:

Тест Ферма

Тест Соловэя-Штрассена

Тест Миллера-Рабина

Практическая значимость: Эти алгоритмы являются фундаментом для генерации больших простых чисел, используемых в современных криптографических системах (RSA, цифровые подписи).

---

# Два подхода к проверке простоты:

Детерминированные тесты	Вероятностные тесты
✅ Дают строгое доказательство простоты.	            ✅ Высокая скорость для больших чисел.
❌ Вычислительно сложны для больших чисел.	            ✅ Вероятность ошибки может быть сделана сколь угодно малой.
❌ Чаще используются для целенаправленной генерации.	✅ Широко применяются для первичной проверки.
Золотой стандарт на практике: Комбинация быстрого вероятностного теста (Миллера-Рабина) с последующим детерминированным тестом для подтверждения.	
## Тест Ферма

Основа: Малая теорема Ферма.
Если n — простое, то для любого a (где 1 < a < n) выполняется:
aⁿ⁻¹ ≡ 1 (mod n)

Алгоритм (упрощённо):
Выбрать случайное число a из диапазона [2, n-2].

Вычислить r = aⁿ⁻¹ mod n.

Если r ≠ 1 → число составное.

Если r = 1 → число вероятно простое.
Недостаток: Пропускает числа Кармайкла (составные числа, ведущие себя как простые).

# Тест Соловэя-Штрассена
Основа: Обобщение теста Ферма с использованием символа Якоби.
Алгоритм (ключевые шаги):
Выбрать случайное основание a.

Вычислить r = a^((n-1)/2) mod n.

Вычислить символ Якоби s = (a/n).

Проверить условие: r ≡ s (mod n).

Если условие выполняется → число вероятно простое.

Особенность: Более надёжен, чем тест Ферма, но требует вычисления символа Якоби, что несколько замедляет работу.

## Тест Миллера-Рабина

Основа: Более строгий анализ сравнений по модулю.
Подготовка:
Разложить n-1 в виде: n-1 = 2ˢ * d, где d — нечётное.

Алгоритм (основная логика):
Для случайного a вычислить последовательность:
aᵈ, a²ᵈ, a⁴ᵈ, ..., a²ˢ⁻¹ᵈ (всё по модулю n).

Если первый элемент не равен 1, а в последовательности нет элемента n-1 → число составное.

Преимущество: Самый надёжный из трёх рассмотренных вероятностных тестов. Вероятность
ошибки ≤ 4⁻ᵏ (для k испытаний).

## Реализация и тестирование (Код)

Реализованные функции:
python
def fermat_test(n, trials=5): ...
def jacobi_symbol(a, n): ... # Для теста Соловэя-Штрассена
def solovay_strassen_test(n, trials=5): ...
def miller_rabin_test(n, trials=5): ...
Ключевая особенность реализации: Использование встроенной функции pow(a, b, mod) для эффективного модульного возведения в степень.

## Результаты выполнения (Контрольный пример)

Тестовые числа: [17, 25, 97, 100, 561]
Вывод программы:
text
Тестируем число: 17
Ферма: Простое
Соловэй-Штрассен: Простое
Миллер-Рабин: Простое

Тестируем число: 25
Ферма: Составное
Соловэй-Штрассен: Составное
Миллер-Рабин: Составное

Тестируем число: 561 (Число Кармайкла)
Ферма: Простое   <-- Ошибка!
Соловэй-Штрассен: Составное
Миллер-Рабин: Составное
Вывод: Тесты Соловэя-Штрассена и Миллера-Рабина корректно определили число Кармайкла (561) как составное, а тест Ферма — ошибся.	
## Выводы и заключение

Итоги работы:
Изучены теоретические основы и реализованы три классических вероятностных теста на простоту.

Тест Миллера-Рабина подтвердил статус наиболее надёжного и рекомендуемого к практическому применению.

Продемонстрирован ключевой недостаток теста Ферма – неспособность обнаруживать числа Кармайкла.

Тест Соловэя-Штрассена показал высокую надёжность, но уступает тесту Миллера-Рабина по эффективности.
Область применения:
Реализованные алгоритмы составляют основу первого этапа проверки при генерации больших простых чисел для криптографии. Для финального подтверждения простоты используется детерминированный тест (например, AKS или тест с использованием эллиптических кривых).
